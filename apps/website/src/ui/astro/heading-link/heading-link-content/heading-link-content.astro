---
import type { HTMLAttributes } from 'astro/types';
import { listenKeys } from 'nanostores';
import { twm } from '@/utilities/twm';
import { headingLinkContentStyles } from './heading-link-content.styles';
import { $headingLinkStore } from '../heading-link-store';

interface Props extends HTMLAttributes<'a'> {
  /**
   * The URL that the link points to.
   */
  href?: string;

  /**
   * Whether the link lead to external source.
   */
  external?: boolean;

  /**
   * Whether the link should open in a new tab.
   */
  openInNewTab?: boolean;
}

const { href, external, openInNewTab, class: className, ...others } = Astro.props;

listenKeys($headingLinkStore, ['id'], () => {});
---

<a
  href={href ? href : $headingLinkStore.get().id ? `#${$headingLinkStore.get().id}` : undefined}
  rel={external ? 'noopener noreferrer' : undefined}
  target={openInNewTab ? '_blank' : undefined}
  class={twm(headingLinkContentStyles(), className)}
  {...others}><slot /></a
>
